#ifndef CHECKM8_H
#define CHECKM8_H

#include <exploit/dfu.h>
#include <exploit/payload.h>

#ifndef MIN
#	define MIN(a, b) ((a) < (b) ? (a) : (b))
#endif

bool checkm8_reset(usb_handle_t *handle);
bool checkm8_heap_feng_shui(usb_handle_t *handle, struct DeviceConfiguration *config);
bool checkm8_trigger_UaF(usb_handle_t *handle, struct DeviceConfiguration *config);
bool checkm8_send_overwrite_and_payload(usb_handle_t *handle, struct DeviceConfiguration *deviceConfig, struct PayloadConfiguration *payloadConfig, bool bootingPongoOS);

bool checkm8_find_device_configuration_for_cpid(int cpid, struct DeviceConfiguration *config);
bool checkm8_find_payload_configuration_for_cpid(int cpid, struct PayloadConfiguration *config);

#endif // CHECKM8_H